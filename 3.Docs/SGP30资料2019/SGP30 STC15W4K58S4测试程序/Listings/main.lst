C51 COMPILER V9.00   MAIN                                                                  05/08/2019 15:27:55 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: d:\Keil_v5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\main
                    -.lst) TABS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          #include "STC15W4K32S4.h"
   2          #include <intrins.h>
   3          #include "sgp30.H" //SHTC3 head file 
   4          #include "delay.h"
   5          #include <stdio.h>
   6          /*************Pin Description*************
   7             SCL -P1.0     
   8             SDA -P1.1   
   9             波特率：115200bps@22.184MHz
  10          *****************************************/
  11          sbit LED = P5^5; //指示灯 
  12          void UartInit(void) //115200bps@22.184MHz
  13          {
  14   1        SCON = 0x50;    //8???,?????
  15   1        AUXR |= 0x40;   //???1???Fosc,?1T
  16   1        AUXR &= 0xFE;   //??1?????1???????
  17   1        TMOD &= 0x0F;   //?????1?16???????
  18   1        TL1 = 0xD0;   //??????
  19   1        TH1 = 0xFF;   //??????
  20   1        ET1 = 0;    //?????1??
  21   1        TR1 = 1;    //?????1
  22   1        
  23   1        REN=1;
  24   1        EA = 1 ; //?????
  25   1        ES = 1 ; //?????
  26   1        TI = 1;   //发送中断标志位，必须设置
  27   1      }
  28           
  29          void main( void )
  30          {
  31   1        unsigned long dat;
  32   1        uchar flag = 0;
  33   1        uint co2Data,TVOCData;
  34   1        UartInit() ;
  35   1        SGP30_Init(); 
  36   1        delay_ms(100);
  37   1        printf("Start!\r\n");
  38   1        while(1) 
  39   1        { 
  40   2            SGP30_ad_write(0x20,0x08);//Measure_air_quality
  41   2            dat = SGP30_ad_read();
  42   2            co2Data = (dat & 0xffff0000) >> 16;
  43   2            TVOCData = dat & 0x0000ffff;    
  44   2            if(co2Data == 400 && TVOCData == 0 && flag == 0)
  45   2            {
  46   3              printf("SGP sensor probing!\r\n");
  47   3              delay_ms(200);
  48   3            }
  49   2              else
  50   2            {
  51   3              printf("TVOC:%d Ppb , co2:%d Ppm\r\n",TVOCData,co2Data);
  52   3              delay_ms(800);
  53   3              flag = 1;
  54   3            }
C51 COMPILER V9.00   MAIN                                                                  05/08/2019 15:27:55 PAGE 2   

  55   2         }
  56   1      } 


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    170    ----
   CONSTANT SIZE    =     58    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       9
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
